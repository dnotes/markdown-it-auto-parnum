!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).markdownItAutoParnum=e()}}(function(){return function(){return function e(t,n,i){function s(r,o){if(!n[r]){if(!t[r]){var a="function"==typeof require&&require;if(!o&&a)return a(r,!0);if(l)return l(r,!0);var h=new Error("Cannot find module '"+r+"'");throw h.code="MODULE_NOT_FOUND",h}var d=n[r]={exports:{}};t[r][0].call(d.exports,function(e){return s(t[r][1][e]||e)},d,d.exports,e,t,n,i)}return n[r].exports}for(var l="function"==typeof require&&require,r=0;r<i.length;r++)s(i[r]);return s}}()({1:[function(e,t,n){"use strict";class i{constructor(e,t){this.state=e,this.options=t,this._elements=["p"],this._value=[],this._headingLevels=t.headingLevels}insertAfter(e,t=!1){let n=t?this.options.headingSign:this.options.sign,i=new this.state.Token("paragraph_number","a",0);i.content=this.value,i.attrPush([this.options.sign,this.value]),i.attrPush(["id",n+this.value]),this.options.addLinks&&i.attrPush(["href",`#${n}${this.value}`]),this.state.tokens.splice(e+1,0,i),this.state.tokens[e].block=!1}increment(e="p"){let t=this._elements.indexOf(e);if(t>-1)for(this._value[2*t]++;t>0;)t--,this._value[2*t]=0}addHeadingElement(e,t=!1){if("number"==typeof t)this._elements[t]=e;else for(let t=this._headingLevels;t>0;t--)if(!this._elements[t]){this._elements[t]=e;break}}set value(e){let t=[...this._value].reverse().join("").replace(/\d+/g,0).split(/(\d+)/).filter(e=>e.length);e.split(/(\d+)/).filter(e=>e.length).forEach((e,n)=>{t[n]=e}),this._value=t.reverse()}get value(){return[...this._value].reverse().join("").replace(/(?:^[0\D]+|(?:[\D]+0)+$)/,"")}set headingLevels(e){this._headingLevels=e,e++,this._elements=this._elements.filter(e=>e),this._elements.length<e&&this._elements.fill(!1,this._elements.length,e-this._elements.length),this._value="0".repeat(e).split("").join(this.options.delimiter).split(/(0)/).filter(e=>e.length)}get headingLevels(){return this._headingLevels}get elements(){return this._elements.filter(e=>e)}}t.exports=function(e,t={}){function n(e){let n=(t.numberedElements||"paragraph").replace(/(,|$)+/g,"_open$&").split(",").filter(e=>e),s=(t.skipElements||"footnote_block").replace(/(.+?)(,|$)+/g,"$1_open,$1_close$2").split(",").filter(e=>e),l=t.sign=t.sign||"\xb6";t.headingSign=t.headingSign||"";let r=!1!==t.numberHeadings;t.headingLevels=void 0===t.headingLevels?1:t.headingLevels;let o=t.delimiter=t.delimiter||".";t.addLinks=void 0===t.addLinks||Boolean(t.addLinks);let a,h,d,u,f=new i(e,t),p={p:0,h1:0,h2:0,h3:0,h4:0,h5:0,h6:0},g={p:"",h1:"",h2:"",h3:"",h4:"",h5:"",h6:""},c=!0,m=0;for(let t=0;t<e.tokens.length;t++)(n+",heading_open").indexOf(e.tokens[t].type)>-1&&(d=/^h\d$/.test(e.tokens[t].tag)?e.tokens[t].tag:"p",(a=e.tokens[t].attrGet(l))&&/\d/.test(a)&&(a=a.replace(/[0-9]+/g,"0"),g[d]||(g[d]=a,g.p.length<g[d].length&&(g.p=g[d]+o+"0"))),p[d]++);g.p&&(f.headingLevels=g.p.split(/[^0-9]+/).length-1),["h6","h5","h4","h3","h2","h1"].forEach(e=>{g[e]&&(h=g[e].split(/[^0-9]+/).length,f.addHeadingElement(e,h))}),g.p||(g.p="0".repeat(f.headingLevels+1).split("").join(o)),f.elements.length<=f.headingLevels&&["h1","h2","h3","h4","h5","h6"].some(e=>{if(p[e]>1&&(1===f.elements.length||-1===f.elements.indexOf(e)&&f.elements[f.elements.length-1]<e)&&f.addHeadingElement(e),f.elements.length>f.headingLevels)return!0}),f.headingLevels=f.elements.filter(e=>e).length-1;for(let t=0;t<e.tokens.length;++t)if("paragraph_number"!==e.tokens[t].type){switch(u=e.tokens[t],a=e.tokens[t].attrGet(l)){case null:break;case"stop":case"off":c=!1;case"none":case"skip":continue;case"auto":case"on":case"start":c=!0;break;default:if(/\d/.test(a)){f.value=a,c=!0,f.insertAfter(t,/^h\d$/.test(u.tag));continue}}if(0===m&&n.indexOf(u.type)>-1){if(!c)continue;if(e.tokens[t+2].tag===e.tokens[t].tag&&"inline"===e.tokens[t+1].type&&1===e.tokens[t+1].children.length&&"text"===e.tokens[t+1].children[0].type&&""===e.tokens[t+1].children[0].content.trim())continue;if(u.hidden&&!["auto","on","start"].indexOf(a)>-1&&(0===t||!("list_item_open"===e.tokens[t-1].type&&["auto","on","start"].indexOf(e.tokens[t-1].attrGet(l))>-1)))continue;f.increment(),f.insertAfter(t)}else 0===m&&c&&"heading_open"===u.type?(f.increment(e.tokens[t].tag),r&&f.elements.indexOf(u.tag)>0&&f.insertAfter(t,!0)):s.indexOf(u.type)>-1&&(m+=u.nesting)}}e.renderer.rules.paragraph_number=function(e,t,n,i,s){return`<a${s.renderAttrs(e[t])}>${e[t].content}</a>`},e.core.ruler.__find__("autoParNum")>-1?e.core.ruler.at("autoParNum",n):e.core.ruler.push("autoParNum",n)}},{}]},{},[1])(1)});
